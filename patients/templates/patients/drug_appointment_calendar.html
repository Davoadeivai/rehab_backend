{% extends 'base.html' %}
{% load static %}

{% block title %}تقویم نوبت دارویی{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">تقویم نوبت دارویی</h2>
    <div id="calendar"></div>
    <div class="mt-4">
        <h3>لیست نوبت‌های دارویی</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>بیمار</th>
                    <th>تاریخ</th>
                    <th>مقدار دارو</th>
                    <th>وضعیت پرداخت</th>
                </tr>
            </thead>
            <tbody>
                {% for appointment in appointments %}
                <tr>
                    <td>{{ appointment.patient.name }}</td>
                    <td>{{ appointment.date }}</td>
                    <td>{{ appointment.amount }}</td>
                    <td>{% if appointment.is_paid %}پرداخت شده{% else %}پرداخت نشده{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css" rel="stylesheet">
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            events: [
                {% for appointment in appointments %}
                {
                    title: '{{ appointment.patient.name }}',
                    start: '{{ appointment.date|date:"Y-m-d" }}',
                    color: '{% if appointment.is_paid %}green{% else %}red{% endif %}'
                },
                {% endfor %}
            ]
        });
        calendar.render();
    });
</script>
{% endblock %} 